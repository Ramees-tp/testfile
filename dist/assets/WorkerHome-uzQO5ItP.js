import{b as w,r as c,j as e,u as y}from"./index-J82VnpFQ.js";import{W as v,a as k}from"./Wfooter-CqT79nZg.js";import{u as C}from"./account-l8IYS-hm.js";import{a as f}from"./workerInstance-j6IIGrT4.js";import{F as S}from"./index-i_Dcum0C.js";import{c as D}from"./index-xM9OYPTF.js";import{C as F}from"./index-C0eKS619.js";import M from"./Wprofile-YGZxempZ.js";import{A as R}from"./About-Muxlj4bc.js";import"./axios-L6U4YIEh.js";function E(){const a=w(t=>t.socket.socket),[o,m]=c.useState([]),l=async()=>{try{const t=await f.get("/worker/workRequest");t.status===200&&m(t.data.requests)}catch(t){console.log(t)}};c.useEffect(()=>{const t=localStorage.getItem("jwt");if(t){const d=h(t),r=d?d.id:null;r&&a.emit("workerConnection",{sender:r})}return l(),a.on("updateRequest",()=>{l()}),()=>{a.off("updateRequest")}},[]);const h=t=>{try{const r=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(i)}catch{return null}},x=async(t,d,r)=>{try{(await f.get(`/worker/acceptOrDecline/${t}?action=${d}`)).status===200&&(a.emit("userUpdateRequest",{userId:r}),l())}catch(i){console.log(i)}};return e.jsx("div",{children:e.jsxs("div",{className:"bg-[#DFE7B4] lg:px-28 md:px-16 sm:px-10 px-4 py-5",children:[e.jsxs("div",{className:"bg-[#FFFFFF] lg:p-10 p-2 rounded mb-4",children:[e.jsx("h1",{className:"sm:mb-5 sm:text-2xl text-xl font-bold",children:"Job Requests :"}),e.jsx("div",{className:"scroll-mx-60 overflow-y-scroll  min-h-72 py-5 tm:px-2 flex flex-col gap-4",children:o&&o.filter(t=>t.status==="pending").map(t=>e.jsx("div",{className:"bg-[#678FB4] tm:p-3 p-1 rounded-md ",children:e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx("div",{className:"rounded-full bg-[#C3B6B6] p-2 mb-4 md:mb-0 mr-4 sm:block hidden",children:e.jsx("img",{src:t.userData.profileImage||C,className:"w-10 h-10"})}),e.jsxs("div",{className:"bg-[#DFE7B4] sm:p-3 rounded-xl w-full flex flex-row tm:gap-x-3 sm:gap-y-4 items-center sm:justify-between justify-around p-1",children:[e.jsxs("h1",{className:"font-semibold  lg:text-2xl sm:text-xl rm:text-lg text-sm p-2 max-w-[18rem] md:max-w-none md:mr-4 text-center",children:[t.userData.firstName," ",t.userData.lastName]}),e.jsxs("div",{className:"flex xl:flex-row flex-col gap-2 items-center justify-center ",children:[e.jsxs("div",{className:"flex flex-row items-center md:gap-y-2 md:gap-x-3 gap-x-1",children:[e.jsx("p",{className:"bg-blue-300 tm:p-2 p-1 rounded font-bold text-sm md:text-xl md:w-36 sm:w-28 text-center",children:new Date(t.date).toLocaleDateString()}),e.jsx("p",{className:"bg-blue-300 tm:p-2 p-1 rounded font-bold text-sm md:text-xl md:w-36 sm:w-28 text-center",children:t.day})]}),e.jsxs("div",{className:"flex flex-row items-center md:gap-y-2 gap-2 md:gap-x-3",children:[e.jsx("button",{onClick:()=>x(t._id,"accept",t.userData.userId),className:"bg-green-700 hover:bg-green-900 tm:p-2 p-1 rounded font-bold text-sm md:text-xl text-white sm:w-24",children:"Accept"}),e.jsx("button",{onClick:()=>x(t._id,"decline",t.userData.userId),className:"bg-red-700 hover:bg-red-900 tm:p-2 p-1 rounded font-bold text-sm md:text-xl text-white sm:w-24",children:"Decline"})]})]})]})]})},t._id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"p-6 md:p-10 rounded bg-[#FFFFFF] shadow-md",children:[e.jsx("h1",{className:"sm:text-3xl text-2xl font-bold mb-4",children:"Contract History"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("p",{className:"font-bold text-lg md:text-xl border-b-2 border-red-900 cursor-pointer",children:"Last week"}),e.jsx("p",{className:"font-bold text-lg md:text-xl cursor-pointer",children:"Last Month"})]}),e.jsx("div",{className:"bg-[#C3B6B6] text-xl font-bold p-4 rounded-lg mt-4",children:e.jsx("h1",{className:"tm:text-base text-md",children:"Total Contracts"})})]}),e.jsxs("div",{className:"p-6 md:p-10 rounded bg-[#FFFFFF] shadow-md",children:[e.jsx("h1",{className:"sm:text-3xl text-2xl font-bold mb-4",children:"Wallet"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-lg md:text-xl font-bold",children:"Todays earnings"}),e.jsx("p",{className:"bg-[#C3B6B6] p-2 rounded-lg",children:"$45"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-lg md:text-xl font-bold",children:"Total Balance"}),e.jsx("p",{className:"bg-[#C3B6B6] p-2 rounded-lg",children:"$5665"})]})]})]})]})]})})}function B({workerId:a,userId:o,requestId:m}){const l=w(n=>n.socket.socket),[h,x]=c.useState([]),[t,d]=c.useState(""),r=n=>{f.post("/user/saveMessages",n)},i=()=>{if(t.trim()!==""){l.emit("sendMessage",{message:t,sender:a,receiver:o,requestId:m});const n={message:t,sender:a,receiver:o,requestId:m};x(p=>[...p,{message:t,sender:a,type:"sent"}]),r(n),d("")}};return c.useEffect(()=>{l.emit("workerConnection",{sender:a})},[]),c.useEffect(()=>{(async()=>{try{const p=await f.get("/user/showMessage",{params:{workerId:a,userId:o,requestId:m}});if(p.data&&p.data.success){const u=p.data.messages;x(u)}}catch(p){console.error(p)}})()},[]),c.useEffect(()=>{const n=({message:p,sender:u,requestId:b})=>{b===m&&x(j=>[...j,{message:p,sender:u,type:"received"}])};return l.on("sendMessage",n),()=>{l.off("sendMessage",n)}},[]),e.jsx("div",{className:"h-full bg-slate-200 rounded-md",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-grow p-4 border-b-2 border-gray-300",children:e.jsx("div",{className:"overflow-y-auto h-full",children:h.map((n,p)=>e.jsx("div",{className:` mb-2 text-lg ${n.sender===a?"flex justify-end":"flex justify-start"}`,children:e.jsxs("div",{className:` max-w-[70%] w-fit p-2 rounded text-white flex flex-col leading-5 ${n.sender===a?"bg-green-900  pl-8 py-1":"bg-gray-700 pr-8"}`,children:[e.jsx("span",{className:"font-bold text-[60%] text-right",children:n.sender===a?"you":""}),e.jsx("span",{className:"",children:n.message})]})},p))})}),e.jsxs("div",{className:"flex items-center lg:p-4 border-t-2 border-gray-300",children:[e.jsx("input",{type:"text",className:"flex-grow h-full mr-2 p-2 border border-gray-300 rounded",placeholder:"Type your message...",value:t,onChange:n=>d(n.target.value)}),e.jsx(S,{icon:D,onClick:i,className:"fa-regular cursor-pointer p-2 h-6 w-6 bg-green-500 text-white rounded hover:bg-green-700"})]})]})})}const W=({requestId:a})=>{y();const[o,m]=c.useState(["","","","","",""]),l=Array.from({length:6},()=>c.useRef(null)),[h,x]=c.useState(""),t=(r,i)=>{const n=[...o];n[r]=i,m(n),i.length===1&&r<l.length-1?l[r+1].current.focus():i.length===0&&r>0&&l[r-1].current.focus()},d=async()=>{try{(await f.post("/worker/verifyOTP",{otpValues:o,orderId:a})).status}catch(r){r.response&&r.response.data.error?x(r.response.data.error):x("Failed to verify OTP. Please try again.")}};return e.jsx("div",{className:"h-full",children:e.jsxs("div",{className:" h-full flex flex-col justify-center text-center gap-y-3 bg-slate-200 p-9 rounded-md",children:[e.jsx("label",{className:" text-xl p-12 font-semibold text-sky-800",children:"Enter Secret Code:"}),e.jsx("div",{className:"flex justify-around mb-10",children:l.map((r,i)=>e.jsx("input",{type:"number",name:"otpValues",className:"w-9 h-9 p-1 border-2 focus:border-sky-900 shadow-xl rounded text-center",maxLength:"1",ref:r,value:o[i],onChange:n=>t(i,n.target.value)},i))}),e.jsx("button",{className:"bg-sky-700 hover:bg-blue-500 text-white shadow-xl p-2 rounded-lg mb-20 font-semibold",onClick:d,children:"Verify OTP"})]})})},I=()=>{const[a,o]=c.useState([]),[m,l]=c.useState(!1),[h,x]=c.useState(!1),[t,d]=c.useState(!1),[r,i]=c.useState(null),[n,p]=c.useState({lat:11.24802,lng:75.7804}),u=async()=>{try{const s=await f.get("/worker/workRequest");s.status===200&&o(s.data.requests)}catch(s){console.log(s)}};c.useEffect(()=>{u()},[]);const b=async s=>{i(s),d(g=>!g),l(!1),x(!1)},j=s=>{i(s),l(g=>!g),x(!1),d(!1)},N=s=>{i(s),x(g=>!g),l(!1),d(!1)};return c.useEffect(()=>{const s=localStorage.getItem("workerLocation");if(s){const{center:g,placeName:O}=JSON.parse(s);p(g)}},[]),e.jsx("div",{children:e.jsxs("div",{className:"sm:min-h-[500px] min-h-[350px]",children:[e.jsx("h2",{className:"tm:text-2xl text-xl font-bold sm:mb-6 mb-3 text-gray-600 underline",children:"Contracts"}),a.length>0&&a.filter(s=>s.payment).map(s=>e.jsxs("div",{className:"flex sm:flex-row flex-col gap-4 mb-5",children:[e.jsxs("div",{className:"-my-2 py-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 md:pr-10 lg:px-8 lg:w-[70%] ",children:[e.jsxs("section",{className:"align-middle   rounded-tl-lg rounded-tr-lg inline-block w-full py-4 overflow-hidden bg-slate-100 shadow-xl md:px-12 px-4 relative",children:[s.completed&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-gray-800 bg-opacity-75 text-white rounded-t-lg sm:px-12",children:e.jsx("p",{className:"text-4xl font-bold text-green-500 p-36"})}),e.jsxs("div",{className:"flex md:flex-row md:items-start items-center flex-col-reverse w-full gap-y-2",children:[e.jsxs("div",{className:"grid md:grid-cols-6 grid-cols-1 sm:grid-rows-3 grid-rows-3 md:gap-5 md:w-[70%] text-gray-800",children:[e.jsxs("p",{className:"sm:col-span-6 flex items-center text-2xl font-bold",children:[" ",s.userData.firstName," ",s.userData.lastName]}),e.jsxs("p",{className:"sm:col-span-6 flex items-center tm:text-xl text-[90%] text-green-900",children:[new Date(s.date).toLocaleDateString()," - ",s.day]}),e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-4 font-semibold tm:text-base text-[80%] text-red-700",children:"OrderID"}),e.jsx("p",{children:s._id})]})]}),e.jsx("div",{className:"md:w-[30%]",children:e.jsx("div",{className:"tm:w-32 w-24 tm:h-32 h-24  rounded-full overflow-hidden bg-gray-200",children:e.jsx("img",{src:s.userData.userImage,alt:"profile",className:"object-cover w-full h-full"})})})]})]}),e.jsxs("section",{className:"align-middle inline-block min-w-full shadow overflow-hidden bg-slate-100 shadow-dashboard lg:px-8 px-2 md:pt-3 rounded-bl-lg rounded-br-lg relative",children:[s.completed&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-gray-800 bg-opacity-75 text-white rounded-b-lg sm:px-12",children:e.jsx("p",{className:"tm:text-4xl text-2xl font-bold text-green-500 p-36 ",children:"Work Completed"})}),e.jsx("p",{className:"text-lg text-gray-700 font-bold",children:"Contact"}),e.jsxs("div",{className:" flex flex-col justify-center mt-4 work-sans bg-white shadow-xl rounded lg:p-6 p-2 mb-5",children:[e.jsxs("div",{className:"grid md:grid-cols-2 md:grid-rows-3 items-center md:w-[30%] md:gap-x-20 md:text-base sm:text-[85%] text-[75%]",children:[e.jsx("p",{className:"  font-bold",children:"Call"}),e.jsx("p",{children:s.userData.phoneNumber}),e.jsx("p",{className:"font-bold",children:"EMAIL"}),e.jsx("p",{children:s.userData.email||"Not available"}),e.jsx("p",{className:"font-bold",children:"Worker ID"}),e.jsx("p",{children:s.userData.userId}),e.jsx("p",{className:"font-bold",children:"Place"}),e.jsx("p",{children:s.userData.city})]}),e.jsxs("div",{className:"md:ml-auto flex justify-center mt-5",children:[e.jsx("button",{onClick:()=>N(s._id),className:" lg:text-base tm:text-[90%] text-[60%] inline-flex lg:px-5 tm:px-4 px-2 md:py-2 py-1 text-purple-600 hover:text-purple-700 focus:text-purple-700 hover:bg-purple-100 focus:bg-purple-100 border border-purple-600 rounded-md ml-3",children:"Map Location"}),e.jsx("button",{onClick:()=>j(s._id),className:" lg:text-base text-[60%] tm:text-[90%] inline-flex lg:px-5 tm:px-4  px-2 md:py-2 py-1 text-red-600 hover:text-red-700 focus:text-red-700 hover:bg-red-100 focus:bg-red-100 border border-red-600 rounded-md ml-3",children:m&&r._id===s._id?"Close Chat":"Live Chat"}),e.jsx("button",{onClick:()=>b(s._id),className:" lg:text-base text-[60%] tm:text-[90%] inline-flex lg:px-5 tm:px-4 px-2 md:py-2 py-1 text-green-600 hover:text-green-700 focus:text-green-700 hover:bg-green-100 focus:bg-green-100 border border-green-600 rounded-md ml-3",children:"Enter OTP"})]})]})]})]}),e.jsx("div",{className:"lg:w-[30%]",children:!s.completed&&e.jsxs(e.Fragment,{children:[m&&r===s._id&&e.jsx(B,{workerId:s.workerId,userId:s.userId,requestId:s._id}),h&&r===s._id&&e.jsx("div",{className:" h-[100%]",children:e.jsx(F,{initialCenter:{lat:s.coordinates[1],lng:s.coordinates[0]},initialStart:n,userType:"worker"})}),t&&r===s._id&&e.jsx("div",{className:" h-[100%]",children:e.jsx(W,{workerId:s.workerId,userId:s.userId,requestId:s._id})})]})})]},s._id))]})})},T=()=>{const[a,o]=c.useState([]),m=async()=>{try{const l=await f.get("/worker/workRequest");l.status===200&&o(l.data.requests)}catch(l){console.log(l)}};return c.useEffect(()=>{m()},[]),e.jsx("div",{children:e.jsxs("div",{className:"sm:min-h-[500px] min-h-[350px]",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 sm:text-left text-center text-gray-600 underline",children:"Accepted Requests"}),e.jsx("div",{className:"-my-2 py-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 sm:pr-10 lg:px-8",children:a.length>0&&a.filter(l=>!l.payment&&l.status==="accepted").map(l=>e.jsx("div",{className:"align-middle rounded-tl-lg rounded-tr-lg inline-block w-full py-4 overflow-hidden bg-white shadow-lg sm:px-12 px-2",children:e.jsx("div",{className:"flex items-center sm:p-8 p-4 bg-[#dae3ee] shadow rounded-lg",children:e.jsx("div",{className:"w-full flex sm:flex-row flex-col justify-center",children:e.jsxs("div",{children:[e.jsx("span",{className:"block text-gray-500",children:l.workerId.jobType}),e.jsxs("span",{className:"block text-2xl font-bold",children:[l.userData.firstName," ",l.userData.lastName]}),e.jsxs("span",{className:"block text-gray-500",children:[new Date(l.date).toLocaleDateString()," - ",l.day]}),e.jsx("span",{className:"block text-gray-500",children:l.userData.city})]})})})},l._id))})]})})},_=()=>{const[a,o]=c.useState(!0),[m,l]=c.useState(!1),[h,x]=c.useState(1),t=d=>{switch(o(!1),l(!1),x(d),d){case 1:o(!0);break;case 2:l(!0);break}};return e.jsx("div",{className:"bg-[#DFE7B4]",children:e.jsxs("main",{className:"p-2 sm:p-10 space-y-6 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col tm:gap-y-6 gap-y-3 md:space-y-0 md:flex-row justify-between sm:items-center",children:[e.jsxs("div",{className:"mr-6 ml-2 mt-2",children:[e.jsx("h1",{className:"md:text-4xl tm:text-3xl text-2xl font-semibold md:mb-2",children:"Contract Details"}),e.jsx("h2",{className:"text-gray-600 ml-0.5 sm:text-base text-[87%]",children:"Your Contracts"})]}),e.jsxs("div",{className:"flex flex-wrap items-start tm:justify-end justify-center -mb-3",children:[e.jsx("button",{onClick:()=>t(1),className:`inline-flex tm:px-4 px-2 tm:py-2 py-1  border border-purple-600 rounded-md mb-3 ${h===1?"bg-purple-600 text-white":"bg-purple-200 text-purple-600"}`,children:"Contracts"}),e.jsx("button",{onClick:()=>t(2),className:`inline-flex tm:px-4 px-2 tm:py-2 py-1  border border-purple-600 rounded-md mb-3 ml-6 ${h===2?"bg-purple-600 text-white":"bg-purple-200 text-purple-600"}`,children:"Pending"})]})]}),e.jsxs("section",{className:"bg-white sm:p-8 p-2 shadow rounded-lg h-full",children:[a&&e.jsx(I,{}),m&&e.jsx(T,{})]})]})})},L=()=>e.jsx("div",{children:e.jsx("section",{className:"py-6 dark:bg-gray-100 dark:text-gray-900 min-h-[500px]",children:e.jsxs("div",{className:"grid max-w-6xl grid-cols-1 px-6 mx-auto lg:px-8 md:grid-cols-2 md:divide-x md:mt-10",children:[e.jsxs("div",{className:"py-6 md:py-0 md:px-6",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Get in touch"}),e.jsx("p",{className:"pt-2 pb-4",children:"Fill in the form to start a conversation"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6",children:e.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Fake address, 9999 City"})]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6",children:e.jsx("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})}),e.jsx("span",{children:"123456789"})]}),e.jsxs("p",{className:"flex items-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 mr-2 sm:mr-6",children:[e.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),e.jsx("span",{children:"contact@business.com"})]})]})]}),e.jsxs("form",{noValidate:"",className:"flex flex-col py-6 space-y-6 md:py-0 md:px-6",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"mb-1",children:"Full name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",className:"block w-full rounded-md shadow-sm focus:ring focus:ring-opacity-75 focus:dark:ring-violet-600 dark:bg-gray-300 p-2"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"mb-1",children:"Email address"}),e.jsx("input",{type:"email",placeholder:"Entermail@jenkins.com",className:"block w-full rounded-md shadow-sm focus:ring focus:ring-opacity-75 focus:dark:ring-violet-600 dark:bg-gray-300 p-2"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"mb-1",children:"Message"}),e.jsx("textarea",{rows:"3",placeholder:"Type Message",className:"block w-full rounded-md focus:ring focus:ring-opacity-75 focus:dark:ring-violet-600 dark:bg-gray-300 p-2"})]}),e.jsx("button",{type:"button",className:"self-center px-6 py-2 text-lg rounded focus:ring hover:ring focus:ring-opacity-75 dark:bg-violet-600 dark:text-gray-50 focus:dark:ring-violet-600 hover:dark:ring-violet-600",children:"Submit"})]})]})})});function K(){const[a,o]=c.useState("WHome"),m=l=>{o(l)};return e.jsxs("div",{className:"tm:p-1",children:[e.jsx(v,{handleNavigation:m}),a==="WHome"&&e.jsx(E,{}),a==="WProfile"&&e.jsx(M,{}),a==="WContracts"&&e.jsx(_,{}),a==="WContact"&&e.jsx(L,{}),a==="WAbout"&&e.jsx(R,{}),e.jsx(k,{})]})}export{K as default};
